# %%
## ğŸ“˜ M1.4 NumPy Broadcasting åŸç†èˆ‡å¯¦å‹™æ‡‰ç”¨

æœ¬æ•™å­¸å°‡è©³ç´°ä»‹ç´¹ NumPy ä¸­çš„ Broadcastingï¼ˆå»£æ’­ï¼‰æ©Ÿåˆ¶ï¼Œé€™æ˜¯ NumPy ä¸­ä¸€å€‹å¼·å¤§çš„åŠŸèƒ½ï¼Œ
å…è¨±å°ä¸åŒå½¢ç‹€çš„é™£åˆ—é€²è¡Œç®—è¡“é‹ç®—ï¼Œå¤§å¹…ç°¡åŒ–ç¨‹å¼ç¢¼ä¸¦æé«˜è¨ˆç®—æ•ˆç‡ã€‚

# %%
### ğŸ¯ æ•™å­¸ç›®æ¨™

- ğŸ” äº†è§£ Broadcasting çš„åŸºæœ¬åŸç†èˆ‡è¦å‰‡
- ğŸ› ï¸ æŒæ¡ Broadcasting åœ¨å¯¦éš›æ‡‰ç”¨ä¸­çš„ä½¿ç”¨æ–¹æ³•
- âš ï¸ å­¸æœƒå¦‚ä½•é¿å… Broadcasting ç›¸é—œçš„å¸¸è¦‹éŒ¯èª¤
- ğŸš€ ç†è§£ Broadcasting å°æ•ˆèƒ½çš„å½±éŸ¿

# %%
### ğŸ§° 1. ç’°å¢ƒè¨­ç½®èˆ‡å°å…¥å¿…è¦çš„å¥—ä»¶

# %%
**å­¸ç¿’è¦é»**ï¼š
- å°å…¥ NumPyã€Matplotlib å’Œæ™‚é–“æ¸¬é‡æ¨¡çµ„
- è¨­å®š NumPy é¡¯ç¤ºé¸é …ä»¥æé«˜è¼¸å‡ºå¯è®€æ€§

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- æ•¸æ“šç§‘å­¸èˆ‡åˆ†æçš„å‰ç½®æº–å‚™
- ç§‘å­¸è¨ˆç®—ä¸­çš„ç’°å¢ƒé…ç½®

# %%
import numpy as np
import matplotlib.pyplot as plt
import time

# è¨­å®šé¡¯ç¤ºé¸é …ï¼Œä½¿è¼¸å‡ºæ›´æ˜“è®€
np.set_printoptions(precision=3, suppress=True)

# %%
**è§£èªª**ï¼š
- `np.set_printoptions(precision=3)` è®“æµ®é»æ•¸é¡¯ç¤ºä¿ç•™3ä½å°æ•¸
- `suppress=True` æŠ‘åˆ¶ç§‘å­¸è¨˜è™Ÿé¡¯ç¤ºï¼Œä½¿å¤§å°æ•¸å­—æ›´æ˜“è®€
- åŒ¯å…¥ matplotlib ç”¨æ–¼è¦–è¦ºåŒ–ï¼Œtime ç”¨æ–¼æ•ˆèƒ½æ¸¬é‡

# %%
### ğŸ“¡ 2. ä»€éº¼æ˜¯ Broadcastingï¼Ÿ

# %%
**å­¸ç¿’è¦é»**ï¼š
- ç†è§£ Broadcasting çš„åŸºæœ¬æ¦‚å¿µ
- æŒæ¡æ¨™é‡èˆ‡é™£åˆ—é–“çš„è‡ªå‹•æ“´å±•æ©Ÿåˆ¶
- é«”æœƒ Broadcasting å¸¶ä¾†çš„ä»£ç¢¼ç°¡åŒ–

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- è³‡æ–™æ¨™æº–åŒ–èˆ‡æ­¸ä¸€åŒ–è™•ç†
- çŸ©é™£é‹ç®—å„ªåŒ–
- å‘é‡åŒ–é‹ç®—å¢å¼·

# %%
Broadcasting æ˜¯ NumPy ä¸­çš„ä¸€å€‹æ©Ÿåˆ¶ï¼Œå…è¨±å°å½¢ç‹€ä¸åŒçš„é™£åˆ—é€²è¡Œç®—è¡“é‹ç®—ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°‡è¼ƒå°çš„é™£åˆ—ã€Œå»£æ’­ã€åˆ°è¼ƒå¤§çš„é™£åˆ—çš„å½¢ç‹€ï¼Œè€Œä¸éœ€è¦å¯¦éš›è¤‡è£½æ•¸æ“šï¼Œå¾è€Œå¯¦ç¾é«˜æ•ˆçš„å‘é‡åŒ–é‹ç®—ã€‚

# %%
# åŸºæœ¬ç¯„ä¾‹ï¼šæ¨™é‡èˆ‡é™£åˆ—é‹ç®—
arr = np.array([1, 2, 3, 4, 5])
scalar = 5

# æ¨™é‡è‡ªå‹•å»£æ’­åˆ°é™£åˆ—çš„æ¯å€‹å…ƒç´ 
result = arr + scalar
print(f"é™£åˆ—: {arr}")
print(f"æ¨™é‡: {scalar}")
print(f"çµæœ (arr + scalar): {result}")

# %%
**è§£èªª**ï¼š
- Broadcasting å…è¨±ä¸åŒå½¢ç‹€çš„é™£åˆ—é€²è¡Œé‹ç®—ï¼Œå…§éƒ¨è‡ªå‹•æ“´å±•è¼ƒå°çš„é™£åˆ—
- æœ€ç°¡å–®çš„ä¾‹å­æ˜¯æ¨™é‡èˆ‡é™£åˆ—é‹ç®—ï¼Œæ¨™é‡è¢«ã€Œçœ‹ä½œã€èˆ‡é™£åˆ—ç›¸åŒå½¢ç‹€
- é€™ç¨®æ©Ÿåˆ¶ä¸æœƒå¯¦éš›ç”¢ç”Ÿå¤§é‡è‡¨æ™‚é™£åˆ—ï¼Œè€Œæ˜¯åœ¨é‹ç®—éç¨‹ä¸­è™›æ“¬æ“´å±•

# %%
### ğŸ“ 3. Broadcasting çš„åŸºæœ¬è¦å‰‡

# %%
**å­¸ç¿’è¦é»**ï¼š
- æŒæ¡ NumPy Broadcasting çš„ä¸‰æ¢åŸºæœ¬è¦å‰‡
- ç†è§£ä¸åŒå½¢ç‹€é™£åˆ—é–“çš„å…¼å®¹æ€§æ¢ä»¶
- å­¸æœƒè¨ºæ–·èˆ‡ç†è§£ Broadcasting éŒ¯èª¤

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- å¤šç¶­æ•¸æ“šè™•ç†ä¸­çš„çŸ©é™£é‹ç®—
- ç‰¹å¾µå·¥ç¨‹ä¸­çš„å‘é‡è®Šæ›
- é«˜ç¶­çµ±è¨ˆåˆ†æä¸­çš„æ•¸çµ„æ“ä½œ

# %% 
NumPy æ¯”è¼ƒå…©å€‹é™£åˆ—çš„å½¢ç‹€ï¼Œå¾æœ€å³å´çš„ç¶­åº¦é–‹å§‹æ¯”è¼ƒï¼š

1. å¦‚æœå…©å€‹é™£åˆ—åœ¨æŸä¸€ç¶­åº¦ä¸Šçš„é•·åº¦ç›¸åŒï¼Œå‰‡å¯åœ¨è©²ç¶­åº¦ä¸Šé€²è¡Œé‹ç®—ã€‚
2. å¦‚æœå…©å€‹é™£åˆ—åœ¨æŸä¸€ç¶­åº¦ä¸Šçš„é•·åº¦ä¸åŒï¼Œä½†å…¶ä¸­ä¸€å€‹ç‚º 1ï¼Œå‰‡é€™å€‹ç¶­åº¦æœƒè¢«æ‹‰ä¼¸ç‚ºå¦ä¸€å€‹é™£åˆ—çš„è©²ç¶­åº¦é•·åº¦ã€‚
3. å¦‚æœå…©å€‹é™£åˆ—åœ¨ä»»ä½•ä¸€å€‹ç¶­åº¦ä¸Šé•·åº¦ä¸åŒ¹é…ï¼Œä¸”æ²’æœ‰ä¸€å€‹é•·åº¦ç‚º 1ï¼Œå‰‡ç„¡æ³•é€²è¡Œå»£æ’­ã€‚

# %%
# å±•ç¤º Broadcasting è¦å‰‡
print("Broadcasting è¦å‰‡ç¤ºä¾‹:")

# 1. å…©å€‹é™£åˆ—å…·æœ‰ç›¸åŒçš„å½¢ç‹€
arr1 = np.array([1, 2, 3])
arr2 = np.array([10, 20, 30])
print(f"\nå½¢ç‹€ç›¸åŒçš„é™£åˆ—ç›¸åŠ :")
print(f"arr1 (å½¢ç‹€ {arr1.shape}): {arr1}")
print(f"arr2 (å½¢ç‹€ {arr2.shape}): {arr2}")
print(f"arr1 + arr2 = {arr1 + arr2}")

# 2. ä¸€å€‹å½¢ç‹€ç‚º (n, m) çš„é™£åˆ—èˆ‡ä¸€å€‹å½¢ç‹€ç‚º (1, m) çš„é™£åˆ—é‹ç®—
arr3 = np.array([[1, 2, 3], [4, 5, 6]])  # å½¢ç‹€ (2, 3)
arr4 = np.array([[10, 20, 30]])          # å½¢ç‹€ (1, 3)
print(f"\nè¡Œå‘é‡å»£æ’­åˆ°çŸ©é™£:")
print(f"arr3 (å½¢ç‹€ {arr3.shape}):\n{arr3}")
print(f"arr4 (å½¢ç‹€ {arr4.shape}):\n{arr4}")
print(f"arr3 + arr4 =\n{arr3 + arr4}")  # arr4 çš„ç¬¬ä¸€ç¶­è¢«å»£æ’­

# 3. ä¸€å€‹å½¢ç‹€ç‚º (n, m) çš„é™£åˆ—èˆ‡ä¸€å€‹å½¢ç‹€ç‚º (n, 1) çš„é™£åˆ—é‹ç®—
arr5 = np.array([[100], [200]])  # å½¢ç‹€ (2, 1)
print(f"\nåˆ—å‘é‡å»£æ’­åˆ°çŸ©é™£:")
print(f"arr3 (å½¢ç‹€ {arr3.shape}):\n{arr3}")
print(f"arr5 (å½¢ç‹€ {arr5.shape}):\n{arr5}")
print(f"arr3 + arr5 =\n{arr3 + arr5}")  # arr5 çš„ç¬¬äºŒç¶­è¢«å»£æ’­

# 4. é‹ç®—ç„¡æ³•å»£æ’­çš„æƒ…æ³
arr6 = np.array([1, 2])  # å½¢ç‹€ (2,)
arr7 = np.array([1, 2, 3])  # å½¢ç‹€ (3,)
print(f"\nç„¡æ³•å»£æ’­çš„é™£åˆ—:")
print(f"arr6 (å½¢ç‹€ {arr6.shape}): {arr6}")
print(f"arr7 (å½¢ç‹€ {arr7.shape}): {arr7}")
try:
    print(f"arr6 + arr7 = {arr6 + arr7}")
except ValueError as e:
    print(f"éŒ¯èª¤: {e}")

# %%
**è§£èªª**ï¼š
- Broadcasting å¾æœ€å³å´ç¶­åº¦é–‹å§‹æ¯”è¼ƒï¼Œç¶­åº¦å¿…é ˆç›¸ç­‰æˆ–å…¶ä¸­ä¸€å€‹ç‚º 1
- äºŒç¶­é™£åˆ—ä¸­ï¼Œè¡Œå‘é‡ (1, n) å¯èˆ‡æ¯ä¸€åˆ—é‹ç®—ï¼Œåˆ—å‘é‡ (n, 1) å¯èˆ‡æ¯ä¸€è¡Œé‹ç®—
- ç•¶å…©å€‹é™£åˆ—ç¶­åº¦ä¸åŒæ™‚ï¼Œè¼ƒå°çš„æœƒè¢«è¦–ç‚ºå¢åŠ ç¶­åº¦1çš„ç‰ˆæœ¬ï¼ˆå·¦å´æ·»åŠ 1ï¼‰
- ç•¶é™£åˆ—ç¶­åº¦å®Œå…¨ä¸å…¼å®¹æ™‚ï¼Œæœƒå¼•ç™¼ ValueErrorï¼Œè¡¨ç¤ºç„¡æ³•å»£æ’­

# %%
### ğŸ§Š 4. å¤šç¶­é™£åˆ—çš„ Broadcasting

# %%
**å­¸ç¿’è¦é»**ï¼š
- ç†è§£é«˜ç¶­é™£åˆ—é–“çš„å»£æ’­è¦å‰‡
- æŒæ¡ä¸åŒç¶­åº¦é™£åˆ—ä¹‹é–“çš„äº¤äº’ä½œç”¨
- å­¸ç¿’å¦‚ä½•é æ¸¬å»£æ’­å¾Œçš„çµæœå½¢ç‹€

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- ä¸‰ç¶­å½±åƒè™•ç†ï¼ˆå¦‚é†«å­¸å½±åƒã€è¦–é »åˆ†æï¼‰
- ç‰©ç†æ¨¡æ“¬ä¸­çš„å¤šç¶­åº¦è¨ˆç®—
- å¼µé‡é‹ç®—åœ¨æ·±åº¦å­¸ç¿’ä¸­çš„æ‡‰ç”¨

# %%
# ä¸‰ç¶­é™£åˆ—èˆ‡äºŒç¶­é™£åˆ—çš„å»£æ’­
arr_3d = np.ones((3, 4, 5))  # å½¢ç‹€ (3, 4, 5)
arr_2d = np.arange(20).reshape(4, 5)  # å½¢ç‹€ (4, 5)

# äºŒç¶­é™£åˆ—å»£æ’­åˆ°ä¸‰ç¶­é™£åˆ—
result_3d_2d = arr_3d + arr_2d
print(f"ä¸‰ç¶­é™£åˆ— (å½¢ç‹€ {arr_3d.shape}) èˆ‡äºŒç¶­é™£åˆ— (å½¢ç‹€ {arr_2d.shape}) ç›¸åŠ ")
print(f"çµæœå½¢ç‹€: {result_3d_2d.shape}")
print(f"çµæœç¬¬ä¸€å±¤:\n{result_3d_2d[0]}")

# ä¸€ç¶­é™£åˆ—å»£æ’­åˆ°ä¸‰ç¶­é™£åˆ—
arr_1d = np.arange(5)  # å½¢ç‹€ (5,)
result_3d_1d = arr_3d + arr_1d
print(f"\nä¸‰ç¶­é™£åˆ— (å½¢ç‹€ {arr_3d.shape}) èˆ‡ä¸€ç¶­é™£åˆ— (å½¢ç‹€ {arr_1d.shape}) ç›¸åŠ ")
print(f"çµæœå½¢ç‹€: {result_3d_1d.shape}")
print(f"çµæœç¬¬ä¸€å±¤ç¬¬ä¸€åˆ—:\n{result_3d_1d[0, 0]}")

# %%
**è§£èªª**ï¼š
- å¤šç¶­å»£æ’­éµå¾ªåŒæ¨£çš„è¦å‰‡ï¼Œå¾æœ€å³å´ç¶­åº¦é–‹å§‹åŒ¹é…
- äºŒç¶­é™£åˆ— (4, 5) å»£æ’­åˆ°ä¸‰ç¶­ (3, 4, 5) æ™‚ï¼Œè™›æ“¬æ·»åŠ ç¬¬ä¸€å€‹ç¶­åº¦è®Šç‚º (1, 4, 5)
- ä¸€ç¶­é™£åˆ— (5,) å»£æ’­åˆ°ä¸‰ç¶­ (3, 4, 5)ï¼Œç›¸ç•¶æ–¼æ“´å±•ç‚º (1, 1, 5)ï¼Œç„¶å¾Œæ“´å±•åˆ° (3, 4, 5)
- å»£æ’­æ“ä½œä¸æœƒå¯¦éš›å‰µå»ºå®Œæ•´çš„æ“´å±•é™£åˆ—ï¼Œè€Œæ˜¯åœ¨è¨ˆç®—æ™‚æŒ‰éœ€ç”Ÿæˆå€¼

# %% 
# ## 5. Broadcasting çš„å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹

# %%
### ğŸ“Š 5. Broadcasting çš„å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹

# %%
### 5.1 æ•¸æ“šæ¨™æº–åŒ– (æ¸›å‡å€¼é™¤ä»¥æ¨™æº–å·®)

# %%
**å­¸ç¿’è¦é»**ï¼š
- åˆ©ç”¨ Broadcasting å¯¦ç¾æ•¸æ“šæ¨™æº–åŒ–
- æŒæ¡æ²¿ç‰¹å®šè»¸è¨ˆç®—çµ±è¨ˆé‡çš„æ–¹æ³•
- ç†è§£æ¨™æº–åŒ–åœ¨æ•¸æ“šé è™•ç†ä¸­çš„é‡è¦æ€§

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- æ©Ÿå™¨å­¸ç¿’æ¨¡å‹çš„æ•¸æ“šé è™•ç†
- ç•°å¸¸å€¼æª¢æ¸¬ä¸­çš„æ•¸æ“šæ­£è¦åŒ–
- ä¸åŒé‡ç´šç‰¹å¾µçš„æ¯”è¼ƒåˆ†æ

# %%
# å‰µå»ºä¸€å€‹ 3x4 çš„éš¨æ©Ÿæ•¸æ“šçŸ©é™£
data = np.random.randn(3, 4)
print(f"åŸå§‹æ•¸æ“š:\n{data}")

# è¨ˆç®—æ¯åˆ—çš„å‡å€¼å’Œæ¨™æº–å·®
mean = data.mean(axis=0)  # æ²¿åˆ—è¨ˆç®—å‡å€¼ (å½¢ç‹€ (4,))
std = data.std(axis=0)    # æ²¿åˆ—è¨ˆç®—æ¨™æº–å·® (å½¢ç‹€ (4,))

print(f"\nåˆ—å‡å€¼: {mean}")
print(f"åˆ—æ¨™æº–å·®: {std}")

# æ¨™æº–åŒ–æ•¸æ“š (Broadcasting è‡ªå‹•æ‡‰ç”¨)
standardized = (data - mean) / std
print(f"\næ¨™æº–åŒ–å¾Œæ•¸æ“š:\n{standardized}")

# é©—è­‰æ¨™æº–åŒ–å¾Œçš„å‡å€¼å’Œæ¨™æº–å·®
print(f"\næ¨™æº–åŒ–å¾Œçš„åˆ—å‡å€¼: {standardized.mean(axis=0)}")
print(f"æ¨™æº–åŒ–å¾Œçš„åˆ—æ¨™æº–å·®: {standardized.std(axis=0)}")

# %%
**è§£èªª**ï¼š
- æ•¸æ“šæ¨™æº–åŒ–é€šéæ¸›å»å‡å€¼ä¸¦é™¤ä»¥æ¨™æº–å·®ï¼Œå°‡æ•¸æ“šè½‰æ›ç‚ºå‡å€¼ç‚º0ã€æ¨™æº–å·®ç‚º1çš„åˆ†å¸ƒ
- `axis=0` æŒ‡å®šæ²¿è‘—åˆ—æ–¹å‘è¨ˆç®—çµ±è¨ˆé‡ï¼Œçµæœæ˜¯å½¢ç‹€ç‚º (4,) çš„å‘é‡
- Broadcasting è‡ªå‹•å°‡ mean å’Œ std å‘é‡æ“´å±•æ‡‰ç”¨åˆ°çŸ©é™£çš„æ¯ä¸€åˆ—
- æ¨™æº–åŒ–æ˜¯æ©Ÿå™¨å­¸ç¿’ä¸­å¸¸ç”¨çš„é è™•ç†æ­¥é©Ÿï¼Œèƒ½æ¶ˆé™¤ä¸åŒç‰¹å¾µé–“çš„å°ºåº¦å·®ç•°

# %%
### 5.2 è·é›¢çŸ©é™£è¨ˆç®—

# %%
**å­¸ç¿’è¦é»**ï¼š
- ä½¿ç”¨ Broadcasting é«˜æ•ˆè¨ˆç®—é»é›†é–“çš„è·é›¢çŸ©é™£
- æ¯”è¼ƒå¾ªç’°æ–¹æ³•èˆ‡å‘é‡åŒ–æ–¹æ³•çš„æ•ˆç‡å·®ç•°
- å­¸ç¿’å¤šç¶­é™£åˆ—æ“´å±•èˆ‡å»£æ’­çš„çµ„åˆæ‡‰ç”¨

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- èšé¡åˆ†æä¸­çš„ç›¸ä¼¼åº¦è¨ˆç®—
- æ¨è–¦ç³»çµ±ä¸­çš„ç”¨æˆ¶/ç‰©å“ç›¸ä¼¼åº¦çŸ©é™£
- ç”Ÿç‰©ä¿¡æ¯å­¸ä¸­çš„åºåˆ—æ¯”å°è·é›¢

# %%
# è¨ˆç®—é»é›†ä¹‹é–“çš„æ­æ°è·é›¢
points = np.random.rand(5, 2)  # 5å€‹äºŒç¶­é»
print(f"éš¨æ©Ÿé»é›† (5å€‹é», 2å€‹åº§æ¨™):\n{points}")

# æ–¹æ³•1: ä½¿ç”¨é›™é‡è¿´åœˆ (ä½æ•ˆ)
n = points.shape[0]
distances_loop = np.zeros((n, n))

start_time = time.time()
for i in range(n):
    for j in range(n):
        # è¨ˆç®—å…©é»ä¹‹é–“çš„æ­æ°è·é›¢
        dist = np.sqrt(np.sum((points[i] - points[j])**2))
        distances_loop[i, j] = dist
loop_time = time.time() - start_time

print(f"\nä½¿ç”¨è¿´åœˆè¨ˆç®—çš„è·é›¢çŸ©é™£:\n{distances_loop}")
print(f"è¿´åœˆæ–¹æ³•è€—æ™‚: {loop_time:.6f} ç§’")

# æ–¹æ³•2: ä½¿ç”¨ Broadcasting (é«˜æ•ˆ)
start_time = time.time()
# é‡å¡‘é»é›†ä»¥ä¾¿å»£æ’­
# å½¢ç‹€ (5, 1, 2) - æ¯ä¸€é»ä½œç‚ºä¸€åˆ—
points_expanded_rows = points[:, np.newaxis, :]
# å½¢ç‹€ (1, 5, 2) - æ¯ä¸€é»ä½œç‚ºä¸€è¡Œ
points_expanded_cols = points[np.newaxis, :, :]

# é€šéå»£æ’­è¨ˆç®—æ¯å°é»çš„å·®ç•°
# å½¢ç‹€ (5, 5, 2) - æ¯å°é»çš„åº§æ¨™å·®
diff = points_expanded_rows - points_expanded_cols
# è¨ˆç®—æ­æ°è·é›¢
distances_broadcast = np.sqrt(np.sum(diff**2, axis=2))
broadcast_time = time.time() - start_time

print(f"\nä½¿ç”¨å»£æ’­è¨ˆç®—çš„è·é›¢çŸ©é™£:\n{distances_broadcast}")
print(f"å»£æ’­æ–¹æ³•è€—æ™‚: {broadcast_time:.6f} ç§’")
print(f"åŠ é€Ÿæ¯”: {loop_time/broadcast_time:.2f}x")

# %%
**è§£èªª**ï¼š
- è·é›¢çŸ©é™£è¨ˆç®—æ˜¯è¨±å¤šæ©Ÿå™¨å­¸ç¿’ç®—æ³•çš„åŸºç¤ï¼Œç›´æ¥å½±éŸ¿æ•ˆèƒ½
- å‚³çµ±çš„é›™é‡å¾ªç’°æ–¹æ³•ç°¡å–®ä½†æ•ˆç‡ä½ï¼Œç‰¹åˆ¥æ˜¯é»æ•¸å¢åŠ æ™‚
- Broadcasting æ–¹æ³•é€šéå°‡é»é›†é‡å¡‘ç‚ºäº’è£œå½¢ç‹€ (5,1,2) å’Œ (1,5,2)ï¼Œå¯¦ç¾è‡ªå‹•é…å°
- é—œéµæ­¥é©Ÿæ˜¯ç†è§£å¦‚ä½•ä½¿ç”¨ `np.newaxis` å¢åŠ ç¶­åº¦ï¼Œä½¿å»£æ’­æ©Ÿåˆ¶èƒ½æ­£ç¢ºé…å°æ¯å…©å€‹é»
- å‘é‡åŒ–æ–¹æ³•é€šå¸¸æ¯”å¾ªç’°å¿«æ•¸ååˆ°æ•¸ç™¾å€ï¼Œå°¤å…¶åœ¨å¤§å‹æ•¸æ“šé›†ä¸Š

# %%
### 5.3 åœ–åƒè™•ç†ï¼šåŠ å…¥æ°´å°

# %%
**å­¸ç¿’è¦é»**ï¼š
- ä½¿ç”¨ Broadcasting å¯¦ç¾åœ–åƒå€åŸŸè™•ç†
- å­¸ç¿’åˆ‡ç‰‡èˆ‡é‹ç®—çµåˆçš„æ•¸æ“šä¿®æ”¹æ–¹æ³•
- æŒæ¡ä¸åŒå½¢ç‹€å€åŸŸçš„æ•¸å€¼ç–ŠåŠ æŠ€å·§

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- åœ–åƒè™•ç†èˆ‡æ°´å°æ·»åŠ 
- å½±åƒåˆ†æä¸­çš„å€åŸŸè™•ç†
- ç†±åœ–èˆ‡æ•¸æ“šè¦–è¦ºåŒ–å¢å¼·

# %%
# å‰µå»ºä¸€å€‹ç°¡å–®çš„ç°åº¦åœ–åƒ
image = np.ones((5, 10)) * 0.5  # 5x10 çš„ç°åº¦åœ–åƒï¼Œåˆå§‹å€¼ç‚º 0.5
print(f"åŸå§‹åœ–åƒ:\n{image}")

# å‰µå»ºä¸€å€‹æ°´å° (ä¾‹å¦‚å³ä¸‹è§’çš„å°çŸ©å½¢)
watermark = np.ones((2, 3)) * 0.2  # 2x3 çš„çŸ©å½¢ï¼Œå€¼ç‚º 0.2

# åœ¨åœ–åƒçš„å³ä¸‹è§’æ·»åŠ æ°´å°
# ä¸éœ€è¦è¿´åœˆï¼Œç›´æ¥ç”¨åˆ‡ç‰‡å’Œè³¦å€¼
image[3:5, 7:10] = image[3:5, 7:10] + watermark
print(f"\næ·»åŠ æ°´å°å¾Œçš„åœ–åƒ:\n{image}")

# %%
**è§£èªª**ï¼š
- åœ–åƒè™•ç†ä¸­ï¼Œå¸¸éœ€è¦å°ç‰¹å®šå€åŸŸé€²è¡Œæ“ä½œï¼Œåˆ‡ç‰‡èˆ‡ Broadcasting çµåˆç‰¹åˆ¥æœ‰ç”¨
- æ­¤ä¾‹ä¸­ï¼Œé€šéåˆ‡ç‰‡ `image[3:5, 7:10]` é¸å®šå³ä¸‹è§’ 2x3 çš„å€åŸŸ
- æ°´å°ç›´æ¥åŠ åˆ°åœ–åƒçš„åˆ‡ç‰‡ä¸Šï¼Œå½¢ç‹€å®Œå…¨åŒ¹é…ï¼Œä¸éœ€é¡å¤–çš„å»£æ’­
- åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œå¯ä»¥ç”¨é¡ä¼¼æ–¹æ³•æ·»åŠ æµ®æ°´å°ã€æ¨™è¨˜ç‰¹å®šå€åŸŸæˆ–é€²è¡Œå€åŸŸå¢å¼·

# %%
### 5.4 å¤šé …å¼è©•ä¼°

# %%
**å­¸ç¿’è¦é»**ï¼š
- ä½¿ç”¨ Broadcasting å¯¦ç¾å¤šé …å¼å‡½æ•¸çš„å‘é‡åŒ–è©•ä¼°
- æ¯”è¼ƒä¸åŒæ–¹æ³•çš„æ•ˆç‡èˆ‡å¯è®€æ€§
- å­¸ç¿’å¦‚ä½•å°‡æ•¸å­¸é‹ç®—è½‰æ›ç‚ºçŸ©é™£é‹ç®—

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- æ›²ç·šæ“¬åˆèˆ‡å‡½æ•¸è¿‘ä¼¼
- ä¿¡è™Ÿè™•ç†ä¸­çš„å¤šé …å¼æ¿¾æ³¢
- ç‰©ç†æ¨¡å‹çš„æ•¸å€¼æ¨¡æ“¬

# %%
# è©•ä¼°ä¸€å€‹å¤šé …å¼åœ¨å¤šå€‹é»ä¸Šçš„å€¼
# ä¾‹å¦‚ï¼šf(x) = 3x^2 + 2x + 1

# å¤šé …å¼ä¿‚æ•¸ [1, 2, 3]ï¼Œè¡¨ç¤º 3x^2 + 2x + 1
coefficients = np.array([1, 2, 3])

# è©•ä¼°é»
x = np.linspace(-2, 2, 5)  # åœ¨ [-2, 2] ç¯„åœå…§å– 5 å€‹é»
print(f"è©•ä¼°é»: {x}")

# æ–¹æ³•1: ä½¿ç”¨è¿´åœˆ
result_loop = np.zeros_like(x)
for i, xi in enumerate(x):
    # è¨ˆç®—å¤šé …å¼å€¼
    result_loop[i] = coefficients[0] + coefficients[1] * xi + coefficients[2] * xi**2

print(f"\nä½¿ç”¨è¿´åœˆè©•ä¼°å¤šé …å¼: {result_loop}")

# æ–¹æ³•2: ä½¿ç”¨ Broadcasting (å‘é‡åŒ–)
# å‰µå»ºå†ªæ¬¡çŸ©é™£ï¼šæ¯è¡Œæ˜¯ä¸€å€‹é»ï¼Œæ¯åˆ—æ˜¯ä¸€å€‹å†ªæ¬¡
powers = np.vstack([x**i for i in range(len(coefficients))])
# ç”¨ä¿‚æ•¸åšé»ç©
result_broadcast = coefficients @ powers
print(f"ä½¿ç”¨å»£æ’­è©•ä¼°å¤šé …å¼: {result_broadcast}")

# æ–¹æ³•3: ä½¿ç”¨ NumPy çš„ polyval å‡½æ•¸
result_polyval = np.polyval(coefficients[::-1], x)
print(f"ä½¿ç”¨ np.polyval è©•ä¼°å¤šé …å¼: {result_polyval}")

# ç¹ªè£½å¤šé …å¼åœ–å½¢
plt.figure(figsize=(8, 5))
x_dense = np.linspace(-2, 2, 100)
y_dense = np.polyval(coefficients[::-1], x_dense)
plt.plot(x_dense, y_dense, 'b-', label='$3x^2 + 2x + 1$')
plt.plot(x, result_broadcast, 'ro', label='è©•ä¼°é»')
plt.axhline(y=0, color='k', linestyle='-', alpha=0.3)
plt.axvline(x=0, color='k', linestyle='-', alpha=0.3)
plt.grid(True, alpha=0.3)
plt.legend()
plt.title('å¤šé …å¼è©•ä¼°ç¤ºä¾‹')
plt.xlabel('x')
plt.ylabel('f(x)')

# %%
**è§£èªª**ï¼š
- å¤šé …å¼è©•ä¼°æ˜¯ç§‘å­¸è¨ˆç®—ä¸­çš„åŸºæœ¬æ“ä½œï¼Œå¯ç”¨æ–¼å‡½æ•¸è¿‘ä¼¼å’Œæ•¸å€¼åˆ†æ
- å¾ªç’°æ–¹æ³•ç›´è§€ä½†ä½æ•ˆï¼Œç‰¹åˆ¥æ˜¯ç•¶è©•ä¼°é»æ•¸é‡å’Œå¤šé …å¼éšæ•¸å¢åŠ æ™‚
- å‘é‡åŒ–æ–¹æ³•å‰µå»ºå†ªæ¬¡çŸ©é™£ï¼Œæ¯è¡Œä»£è¡¨ä¸€å€‹å†ªæ¬¡ (xâ°, xÂ¹, xÂ²...)ï¼Œç„¶å¾Œèˆ‡ä¿‚æ•¸å‘é‡åšé»ç©
- `np.polyval` æ˜¯æœ€ç°¡æ½”çš„æ–¹æ³•ï¼Œä½†äº†è§£å¦‚ä½•ç”¨ Broadcasting å¯¦ç¾æœ‰åŠ©æ–¼ç†è§£åº•å±¤é‹ç®—
- é€™ç¨®æŠ€è¡“å¯æ¨å»£åˆ°æ›´è¤‡é›œçš„å‡½æ•¸è©•ä¼°ï¼Œå¦‚å‚…ç«‹è‘‰ç´šæ•¸ã€æ³°å‹’å±•é–‹ç­‰

# %%
### ğŸ’¾ 6. Broadcasting èˆ‡è¨˜æ†¶é«”æ•ˆç‡

# %%
**å­¸ç¿’è¦é»**ï¼š
- ç†è§£ Broadcasting å°è¨˜æ†¶é«”ä½¿ç”¨çš„å½±éŸ¿
- æ¯”è¼ƒé¡¯å¼å‰µå»ºå¤§é™£åˆ—èˆ‡éš±å¼å»£æ’­çš„æ•ˆç‡å·®ç•°
- æŒæ¡å¦‚ä½•é¸æ“‡æœ€ä½³çš„é™£åˆ—æ“ä½œæ–¹æ³•

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- å¤§è¦æ¨¡æ•¸æ“šè™•ç†çš„å„ªåŒ–
- è¨˜æ†¶é«”å—é™ç’°å¢ƒä¸­çš„è¨ˆç®—
- é«˜æ•ˆèƒ½ç§‘å­¸è¨ˆç®—èˆ‡æ¨¡æ“¬

# %%
# æ¯”è¼ƒ Broadcasting èˆ‡é¡¯å¼å‰µå»ºå¤§å‹é™£åˆ—çš„è¨˜æ†¶é«”ä½¿ç”¨
size = 1000
large_array = np.random.rand(size, size)
print(f"å¤§å‹é™£åˆ—å½¢ç‹€: {large_array.shape}")

# æ–¹æ³•1: é¡¯å¼å‰µå»ºåŒå¤§å°çš„é™£åˆ—å¾Œç›¸åŠ  (æµªè²»è¨˜æ†¶é«”)
scalar = 5
start_time = time.time()
# å‰µå»ºèˆ‡ large_array ç›¸åŒå½¢ç‹€çš„å…¨ scalar é™£åˆ—
scalar_array = np.full_like(large_array, scalar)
# ç›¸åŠ 
result1 = large_array + scalar_array
method1_time = time.time() - start_time
print(f"æ–¹æ³•1 (é¡¯å¼é™£åˆ—) è€—æ™‚: {method1_time:.6f} ç§’")

# æ–¹æ³•2: ä½¿ç”¨ Broadcasting (é«˜æ•ˆ)
start_time = time.time()
result2 = large_array + scalar
method2_time = time.time() - start_time
print(f"æ–¹æ³•2 (Broadcasting) è€—æ™‚: {method2_time:.6f} ç§’")
print(f"æ–¹æ³•1/æ–¹æ³•2 è€—æ™‚æ¯”: {method1_time/method2_time:.2f}x")

# é©—è­‰çµæœç›¸åŒ
print(f"å…©ç¨®æ–¹æ³•çµæœæ˜¯å¦ç›¸åŒ: {np.allclose(result1, result2)}")

# %%
**è§£èªª**ï¼š
- Broadcasting ä¸åƒ…ä»£ç¢¼ç°¡æ½”ï¼Œé‚„èƒ½å¤§å¹…é™ä½è¨˜æ†¶é«”ä½¿ç”¨
- é¡¯å¼å‰µå»ºå®Œæ•´é™£åˆ— (`np.full_like`) éœ€è¦é¡å¤–åˆ†é…èˆ‡åŸé™£åˆ—ç›¸åŒå¤§å°çš„è¨˜æ†¶é«”
- è€Œ Broadcasting (`large_array + scalar`) åœ¨å…§éƒ¨å„ªåŒ–æ™‚ä¸éœ€è¦å‰µå»ºå®Œæ•´çš„è‡¨æ™‚é™£åˆ—
- é€™ç¨®æ•ˆç‡å·®ç•°åœ¨å¤§è¦æ¨¡è¨ˆç®—ä¸­å°¤ç‚ºæ˜é¡¯ï¼Œå¯èƒ½å°è‡´æ•¸å€çš„æ€§èƒ½å·®è·
- å°æ–¼å¤§å‹æ•¸æ“šåˆ†æï¼Œå„ªå…ˆè€ƒæ…®ä½¿ç”¨ Broadcasting æ©Ÿåˆ¶è€Œéé¡¯å¼æ“´å±•

# %%
### âš ï¸ 7. Broadcasting çš„å¸¸è¦‹éŒ¯èª¤èˆ‡è§£æ±ºæ–¹æ¡ˆ

# %%
**å­¸ç¿’è¦é»**ï¼š
- è­˜åˆ¥å¸¸è¦‹çš„ Broadcasting éŒ¯èª¤é¡å‹
- å­¸ç¿’è¨ºæ–·èˆ‡ä¿®å¾©å½¢ç‹€ä¸å…¼å®¹å•é¡Œ
- æŒæ¡é™£åˆ—é‡å¡‘ä»¥åŒ¹é…å»£æ’­éœ€æ±‚çš„æŠ€å·§

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- å¤šç¶­æ•¸æ“šè™•ç†çš„éŒ¯èª¤æ’é™¤
- è¤‡é›œå½¢ç‹€é™£åˆ—é‹ç®—çš„èª¿è©¦
- é«˜æ•ˆæ•¸æ“šè½‰æ›èˆ‡æ ¼å¼åŒ¹é…

# %%
# å¸¸è¦‹éŒ¯èª¤1: å½¢ç‹€ä¸å…¼å®¹
arr_a = np.random.rand(3, 4)
arr_b = np.random.rand(2, 4)
print(f"arr_a å½¢ç‹€: {arr_a.shape}")
print(f"arr_b å½¢ç‹€: {arr_b.shape}")

try:
    result = arr_a + arr_b
except ValueError as e:
    print(f"éŒ¯èª¤: {e}")
    print("è§£æ±ºæ–¹æ¡ˆ1: ç¢ºä¿é™£åˆ—å½¢ç‹€å…¼å®¹")
    print("è§£æ±ºæ–¹æ¡ˆ2: é‡å¡‘å…¶ä¸­ä¸€å€‹é™£åˆ—")

# è§£æ±ºæ–¹æ³•: é‡å¡‘å…¶ä¸­ä¸€å€‹é™£åˆ—æˆ–ä½¿ç”¨å…¶ä»–å‡½æ•¸
# ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘å€‘åªæƒ³ä½¿ç”¨ arr_b çš„å‰3è¡Œ
arr_b_compatible = arr_b[:arr_a.shape[0]]
print(f"\nèª¿æ•´å¾Œ arr_b å½¢ç‹€: {arr_b_compatible.shape}")
result = arr_a + arr_b_compatible
print(f"æˆåŠŸç›¸åŠ !")

# å¸¸è¦‹éŒ¯èª¤2: å»£æ’­æ–¹å‘éŒ¯èª¤
arr_c = np.random.rand(4, 1)  # åˆ—å‘é‡
arr_d = np.random.rand(3)     # ä¸€ç¶­é™£åˆ—
print(f"\narr_c å½¢ç‹€: {arr_c.shape}")
print(f"arr_d å½¢ç‹€: {arr_d.shape}")

try:
    result = arr_c + arr_d
except ValueError as e:
    print(f"éŒ¯èª¤: {e}")
    print("è§£æ±ºæ–¹æ¡ˆ: è½‰ç½®æˆ–é‡å¡‘é™£åˆ—ä»¥åŒ¹é…å»£æ’­æ–¹å‘")

# è§£æ±ºæ–¹æ³•: æ”¹è®Šå½¢ç‹€ä½¿å»£æ’­æ–¹å‘åŒ¹é…
arr_d_reshaped = arr_d.reshape(1, -1)  # è®Šæˆè¡Œå‘é‡ (1, 3)
print(f"\né‡å¡‘å¾Œ arr_d å½¢ç‹€: {arr_d_reshaped.shape}")

# ç¾åœ¨å¯ä»¥å»£æ’­ï¼Œä½†ä»éœ€è¦ç›¸å®¹çš„å½¢ç‹€
try:
    result = arr_c + arr_d_reshaped
except ValueError as e:
    print(f"ä»ç„¶æœ‰éŒ¯èª¤: {e}")
    print("éœ€è¦é€²ä¸€æ­¥èª¿æ•´å½¢ç‹€")

# æ­£ç¢ºèª¿æ•´å…©å€‹é™£åˆ—ä½¿å…¶å…¼å®¹
# å‡è¨­æˆ‘å€‘æƒ³è¦ä¸€å€‹ 4x3 çš„çµæœ
arr_c_adjusted = np.broadcast_to(arr_c, (4, 3))
arr_d_adjusted = np.broadcast_to(arr_d_reshaped, (4, 3))
print(f"\nèª¿æ•´å¾Œ arr_c å½¢ç‹€: {arr_c_adjusted.shape}")
print(f"èª¿æ•´å¾Œ arr_d å½¢ç‹€: {arr_d_adjusted.shape}")
result = arr_c_adjusted + arr_d_adjusted
print(f"æˆåŠŸç›¸åŠ ï¼Œçµæœå½¢ç‹€: {result.shape}")

# %%
**è§£èªª**ï¼š
- Broadcasting éŒ¯èª¤é€šå¸¸ç™¼ç”Ÿåœ¨å˜—è©¦çµ„åˆå½¢ç‹€ä¸å…¼å®¹çš„é™£åˆ—æ™‚
- ç†è§£éŒ¯èª¤æ¶ˆæ¯æ˜¯é—œéµï¼Œé€šå¸¸è¡¨ç¤º "operands could not be broadcast together with shapes ..."
- å¸¸è¦‹è§£æ±ºæ–¹æ¡ˆåŒ…æ‹¬ï¼š
  1. åˆ‡ç‰‡é¸å–å…¼å®¹éƒ¨åˆ† (å¦‚ä¾‹å­ä¸­çš„ `arr_b[:arr_a.shape[0]]`)
  2. ä½¿ç”¨ reshape é‡å¡‘é™£åˆ—ç¶­åº¦ (å¦‚ `arr_d.reshape(1, -1)`)
  3. ä½¿ç”¨ `np.broadcast_to` é¡¯å¼æ“´å±•ç‚ºç›®æ¨™å½¢ç‹€
- å»£æ’­æ–¹å‘æ˜¯é—œéµè€ƒæ…®ï¼Œç‰¹åˆ¥æ˜¯åœ¨è¡Œ/åˆ—å‘é‡èˆ‡çŸ©é™£çš„é‹ç®—ä¸­

# %%
### ğŸ”§ 8. ä½¿ç”¨ np.newaxis å’Œ reshape è¼”åŠ© Broadcasting

# %%
**å­¸ç¿’è¦é»**ï¼š
- æŒæ¡ `np.newaxis` æ·»åŠ ç¶­åº¦çš„ä½¿ç”¨æ–¹æ³•
- å­¸ç¿’ `reshape` èª¿æ•´é™£åˆ—å½¢ç‹€çš„æŠ€å·§
- ç†è§£å…©è€…åœ¨ Broadcasting ä¸­çš„å¯¦éš›æ‡‰ç”¨

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- çŸ©é™£é‹ç®—ä¸­çš„å‘é‡æ“´å±•
- å¼µé‡è¨ˆç®—ä¸­çš„ç¶­åº¦èª¿æ•´
- å¤–ç©èˆ‡å…§ç©ç­‰é«˜ç´šçŸ©é™£é‹ç®—

# %%
# np.newaxis (ç­‰æ–¼ None) ç”¨æ–¼æ’å…¥ä¸€å€‹é•·åº¦ç‚º 1 çš„ç¶­åº¦
arr1d = np.array([1, 2, 3, 4])
print(f"åŸå§‹ä¸€ç¶­é™£åˆ— (å½¢ç‹€ {arr1d.shape}): {arr1d}")

# æ·»åŠ ä¸€å€‹åˆ—ç¶­åº¦ â†’ è®Šç‚ºåˆ—å‘é‡ (4, 1)
col_vector = arr1d[:, np.newaxis]
print(f"\nåˆ—å‘é‡ (å½¢ç‹€ {col_vector.shape}):\n{col_vector}")

# æ·»åŠ ä¸€å€‹è¡Œç¶­åº¦ â†’ è®Šç‚ºè¡Œå‘é‡ (1, 4)
row_vector = arr1d[np.newaxis, :]
print(f"\nè¡Œå‘é‡ (å½¢ç‹€ {row_vector.shape}):\n{row_vector}")

# ä½¿ç”¨ reshape é”åˆ°ç›¸åŒæ•ˆæœ
col_vector_reshaped = arr1d.reshape(-1, 1)
row_vector_reshaped = arr1d.reshape(1, -1)
print(f"\nreshape åˆ—å‘é‡ (å½¢ç‹€ {col_vector_reshaped.shape}):\n{col_vector_reshaped}")
print(f"reshape è¡Œå‘é‡ (å½¢ç‹€ {row_vector_reshaped.shape}):\n{row_vector_reshaped}")

# ä½¿ç”¨é€™äº›æŠ€å·§é€²è¡Œå¤–ç©è¨ˆç®— (outer product)
# åˆ—å‘é‡ä¹˜ä»¥è¡Œå‘é‡ â†’ çŸ©é™£
outer_product = col_vector * row_vector
print(f"\nå¤–ç© (å½¢ç‹€ {outer_product.shape}):\n{outer_product}")

# %%
**è§£èªª**ï¼š
- `np.newaxis` (æˆ– `None`) æ˜¯åœ¨æŒ‡å®šä½ç½®æ’å…¥ä¸€å€‹æ–°çš„è»¸ï¼ˆç¶­åº¦ï¼‰çš„å¿«æ·æ–¹å¼
- `reshape` æä¾›æ›´é€šç”¨çš„å½¢ç‹€èª¿æ•´ï¼Œç‰¹åˆ¥æ˜¯ `-1` åƒæ•¸å…è¨±è‡ªå‹•è¨ˆç®—è©²ç¶­åº¦å¤§å°
- é€™å…©ç¨®æ–¹æ³•åœ¨åŠŸèƒ½ä¸Šæœ‰é‡ç–Šï¼Œé¸æ“‡å“ªä¸€ç¨®å–æ±ºæ–¼ä»£ç¢¼å¯è®€æ€§å’Œå€‹äººåå¥½
- å¤–ç©è¨ˆç®—æ˜¯å…¸å‹æ‡‰ç”¨ï¼Œå°‡ä¸€ç¶­å‘é‡ (n,) è®Šç‚ºåˆ—å‘é‡ (n,1) èˆ‡è¡Œå‘é‡ (1,m) ç›¸ä¹˜ï¼Œå¾—åˆ°çŸ©é™£ (n,m)
- é€™äº›å·¥å…·å°æ–¼èª¿æ•´é™£åˆ—å½¢ç‹€ä»¥é©æ‡‰å»£æ’­è¦å‰‡éå¸¸æœ‰ç”¨

# %%
### ğŸ”¢ 9. Broadcasting èˆ‡çŸ©é™£è¨ˆç®—çš„æ¯”è¼ƒ

# %%
**å­¸ç¿’è¦é»**ï¼š
- å€åˆ†å…ƒç´ ç´šé‹ç®—èˆ‡çŸ©é™£é‹ç®—çš„å·®ç•°
- ç†è§£ Broadcasting åœ¨çŸ©é™£é‹ç®—ä¸­çš„æ‡‰ç”¨
- æŒæ¡ä¸åŒçŸ©é™£æ“ä½œç¬¦ï¼ˆ`*`, `@`, `dot`ï¼‰çš„ä½¿ç”¨å ´æ™¯

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- ç·šæ€§ä»£æ•¸è¨ˆç®—
- çµ±è¨ˆæ¨¡å‹ä¸­çš„çŸ©é™£é‹ç®—
- æ·±åº¦å­¸ç¿’ä¸­çš„å±¤ç´šè¨ˆç®—

# %%
# å»ºç«‹å…©å€‹çŸ©é™£
A = np.array([[1, 2], [3, 4]])
B = np.array([[5, 6], [7, 8]])
print(f"çŸ©é™£ A:\n{A}")
print(f"çŸ©é™£ B:\n{B}")

# å…ƒç´ å°å…ƒç´ ç›¸ä¹˜ (Hadamard ç©) - ä½¿ç”¨ *
C = A * B
print(f"\nå…ƒç´ å°å…ƒç´ ç›¸ä¹˜ (A * B):\n{C}")

# çŸ©é™£ä¹˜æ³• - ä½¿ç”¨ @ é‹ç®—ç¬¦æˆ– np.matmul() æˆ– np.dot()
D = A @ B  # ç­‰åŒæ–¼ np.matmul(A, B) æˆ– np.dot(A, B)
print(f"\nçŸ©é™£ä¹˜æ³• (A @ B):\n{D}")

# ä½¿ç”¨ Broadcasting å¯¦ç¾æŸäº›çŸ©é™£æ“ä½œ
# ä¾‹å¦‚ï¼šå°‡æ¯åˆ—åŠ ä¸Šä¸€å€‹å‘é‡
row_add = np.array([10, 20])
print(f"\nå‘é‡ row_add: {row_add}")
print(f"A çš„æ¯åˆ—åŠ ä¸Š row_add:\n{A + row_add}")  # Broadcasting

# æ¯è¡ŒåŠ ä¸Šä¸€å€‹å‘é‡
col_add = np.array([[100], [200]])
print(f"\nå‘é‡ col_add:\n{col_add}")
print(f"A çš„æ¯è¡ŒåŠ ä¸Š col_add:\n{A + col_add}")  # Broadcasting

# %%
**è§£èªª**ï¼š
- åœ¨ NumPy ä¸­ï¼Œ`*` é‹ç®—ç¬¦åŸ·è¡Œå…ƒç´ å°å…ƒç´ ç›¸ä¹˜ï¼ˆHadamard ç©ï¼‰ï¼Œä¸åŒæ–¼å‚³çµ±çŸ©é™£ä¹˜æ³•
- çŸ©é™£ä¹˜æ³•ï¼ˆé»ç©ï¼‰ä½¿ç”¨ `@` é‹ç®—ç¬¦æˆ– `np.matmul()`/`np.dot()` å‡½æ•¸
- Broadcasting æ¥µå¤§ç°¡åŒ–äº†å‘é‡èˆ‡çŸ©é™£é–“çš„é‹ç®—ï¼Œå¦‚å‘é‡åŠ åˆ°çŸ©é™£çš„æ¯ä¸€è¡Œæˆ–æ¯ä¸€åˆ—
- ç†è§£é€™äº›å·®ç•°å°æ–¼æ­£ç¢ºå¯¦ç¾ç·šæ€§ä»£æ•¸ç®—æ³•è‡³é—œé‡è¦ï¼Œé¿å…å¸¸è¦‹çš„æ•¸å­¸é‹ç®—éŒ¯èª¤

# %%
### ğŸ“ 10. ç¸½çµèˆ‡æœ€ä½³å¯¦è¸

# %%
**å­¸ç¿’è¦é»**ï¼š
- å…¨é¢å›é¡§ Broadcasting çš„å„ªé»èˆ‡æ‡‰ç”¨å ´æ™¯
- æŒæ¡ä½¿ç”¨ Broadcasting çš„æœ€ä½³å¯¦è¸
- äº†è§£ä½•æ™‚ä½¿ç”¨èˆ‡é¿å…ä½¿ç”¨ Broadcasting çš„å ´æ™¯

**æ‡‰ç”¨å ´åŸŸ**ï¼š
- é«˜æ•ˆèƒ½ç§‘å­¸è¨ˆç®—çš„ä»£ç¢¼å„ªåŒ–
- å¤§è¦æ¨¡æ•¸æ“šè™•ç†çš„æ•ˆç‡æå‡
- è¤‡é›œæ•¸æ“šæ“ä½œçš„ç°¡åŒ–å¯¦ç¾

# %% 
# ### Broadcasting çš„å„ªé»
# 
# 1. **ç°¡åŒ–ä»£ç¢¼**ï¼šä¸éœ€è¦é¡¯å¼å¾ªç’°æˆ–è¤‡è£½æ•¸æ“š
# 2. **æé«˜æ•ˆç‡**ï¼šé¿å…ä¸å¿…è¦çš„è¨˜æ†¶é«”ä½¿ç”¨å’Œè¨ˆç®—
# 3. **å¢åŠ å¯è®€æ€§**ï¼šä»£ç¢¼æ›´ç°¡æ½”ï¼Œæ„åœ–æ›´æ˜ç¢º
# 
# ### Broadcasting çš„ä½¿ç”¨å»ºè­°
# 
# 1. **äº†è§£å½¢ç‹€è¦å‰‡**ï¼šå¾å°¾éƒ¨ç¶­åº¦é–‹å§‹æ¯”è¼ƒï¼Œç¶­åº¦å¿…é ˆç›¸ç­‰æˆ–å…¶ä¸­ä¸€å€‹ç‚º 1
# 2. **ç¢ºä¿å…¼å®¹æ€§**ï¼šåœ¨é‹ç®—å‰ç¢ºèªé™£åˆ—å½¢ç‹€æ˜¯å¦å…¼å®¹
# 3. **ä½¿ç”¨è¼”åŠ©å·¥å…·**ï¼š`np.newaxis`, `reshape`, `expand_dims` ç­‰å¹«åŠ©èª¿æ•´å½¢ç‹€
# 4. **è¬¹æ…ä½¿ç”¨**ï¼šç•¶å½¢ç‹€è¤‡é›œæ™‚ï¼Œå¯ä»¥å…ˆæ‰“å°å½¢ç‹€ä»¥ç¢ºä¿æ­£ç¢º
# 5. **æ•ˆèƒ½è€ƒé‡**ï¼šå°æ–¼éå¸¸å¤§çš„é™£åˆ—ï¼ŒBroadcasting å¯èƒ½æœƒéš±å¼å‰µå»ºå¤§é‡è‡¨æ™‚æ•¸æ“š
# 
# ### å¸¸è¦‹æ‡‰ç”¨å ´æ™¯
# 
# 1. **æ•¸æ“šæ¨™æº–åŒ–**ï¼šæ¯åˆ—æ¸›å»å‡å€¼é™¤ä»¥æ¨™æº–å·®
# 2. **çŸ©é™£é‹ç®—**ï¼šç‚ºçŸ©é™£çš„æ¯åˆ—æˆ–æ¯è¡Œæ·»åŠ ä¸€å€‹å‘é‡
# 3. **åœ–åƒè™•ç†**ï¼šä¿®æ”¹åœ–åƒçš„ç‰¹å®šå€åŸŸæˆ–é€šé“
# 4. **å¤šç¶­æ•¸æ“šåˆ†æ**ï¼šåœ¨ä¸åŒç¶­åº¦ä¸Šæ‡‰ç”¨ä¸åŒçš„é‹ç®— 

# %%
**è§£èªª**ï¼š
- Broadcasting æ˜¯ NumPy ä¸­æœ€å¼·å¤§ä½†ä¹Ÿå®¹æ˜“è¢«èª¤è§£çš„ç‰¹æ€§ä¹‹ä¸€
- æ­£ç¢ºä½¿ç”¨å¯ä»¥é¡¯è‘—æé«˜ä»£ç¢¼æ•ˆç‡å’Œå¯è®€æ€§ï¼Œé¿å…é¡¯å¼å¾ªç’°å’Œè‡¨æ™‚é™£åˆ—
- èª¿è©¦å½¢ç‹€å•é¡Œæ™‚ï¼Œæ‰“å°é™£åˆ—çš„ `.shape` å±¬æ€§æ˜¯æœ€æœ‰æ•ˆçš„å·¥å…·
- åœ¨è™•ç†è¤‡é›œå½¢ç‹€æ™‚ï¼Œå¯è€ƒæ…®é€æ­¥åˆ†è§£æ“ä½œï¼Œç¢ºä¿æ¯æ­¥å»£æ’­è¡Œç‚ºç¬¦åˆé æœŸ
- å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œå¤šçµåˆ `reshape`ã€`transpose`ã€`np.newaxis` ç­‰å·¥å…·éˆæ´»èª¿æ•´é™£åˆ—å½¢ç‹€ 